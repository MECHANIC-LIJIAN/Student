{extend name="public/admin_base"}
{block name="title"}{$template.tname}{/block}
{block name="page-main"}
<div class="row">
    <div class="col-xs-12">
        <div class="widget radius-bordered">

            <div class="form-horizontal">
                <input type="text" class="form-control" style="width: 60%;" value="{$shareUrl}" readonly
                    id="textAreas" />
                <a href="javascript:;" id="copy">复制</a>
            </div>
            <div>
                <table id="table" name="table" class="table table-striped table-hover table-bordered"></table>
            </div>

        </div>
    </div>
</div>
{/block}

{block name="page-js"}
<link rel="stylesheet" href="__LIB__/bootstrap-table/bootstrap-table.min.css">
<script src="__LIB__/bootstrap-table/bootstrap-table.min.js"></script>
<script src="__LIB__/bootstrap-table/locale/bootstrap-table-zh-CN.js"></script>
<script src="__LIB__/bootstrap-table/extensions/export/bootstrap-table-export.min.js"></script>
<script src="__LIB__/bootstrap-table/extensions/tableExport.js"></script>
<script>
    $(function () {
        //1.初始化Table
        var oTable = new TableInit();
        oTable.Init();
        // 2. 初始化Button的点击事件
        var oButtonInit = new ButtonInit();
        oButtonInit.Init();

        $("#copy").click(function () {
            var e = document.getElementById("textAreas");
            e.select(); // 选择对象 
            document.execCommand("Copy"); // 执行浏览器复制命令 
            showMsg("复制成功")
        })
    });

    var TableInit = function () {
        var oTableInit = new Object();
        //初始化Table
        oTableInit.Init = function () {
            $("#table").bootstrapTable('destroy'); //避免重复执行，需要销毁
            $("#table").bootstrapTable({
                url: "{:url('admin/Templates/dataList')}",
                method: "post", //请求方式（*）
                toolbar: "#toolbar", //工具按钮用哪个容器
                striped: false, //是否显示行间隔色
                cache: false, //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                pagination: true, //是否显示分页（*）
                queryParams: oTableInit.queryParams, //传递参数（*）
                sidePagination: "server", //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1, //初始化加载第一页，默认第一页
                pageSize: 15, //每页的记录行数（*）
                pageList: [25, 30, 50], //可供选择的每页的行数（*）
                showRefresh: true, //是否显示刷新按钮
                minimumCountColumns: 2, //最少允许的列数
                clickToSelect: true, //是否启用点击选中行
                height: 750, //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                uniqueId: "ID", //每一行的唯一标识，一般为主键列
                detailView: false, //是否显示父子表
                //显示导出插件
                showExport: true,
                //导出文件类型
                exportTypes: ['json', 'csv', 'excel'],
                //文件名称设置
                exportOptions: {
                    fileName: "{$template.tname}"
                },

                columns: { $fields| raw
            }
            });
    };

    //得到查询的参数
    oTableInit.queryParams = function (params) {
        var temp = {
            //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
            limit: params.limit, //页面大小
            offset: params.offset
        };
        return temp;

    };

    return oTableInit;
    };

    var ButtonInit = function () {
        var oInit = new Object();
        var postdata = {};
        oInit.Init = function () {
            //初始化页面上面的按钮事件
        };

        return oInit;
    };
</script>

{/block}