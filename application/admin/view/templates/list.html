{extend name="public/admin_base"}

{block name="page-main"}
<div class="row">
    <div class="col-xs-12">
        <div class="widget radius-bordered">
            <div class="widget">
                <div class="widget-header">
                    <span class="widget-caption">管理员列表</span>
                    <div class="widget-buttons">

                    </div>
                </div>
                <div class="widget-body">
                    <table class="table table-hover table-bordered">
                        <thead>
                            <tr>
                                <th>任务名</th>
                                <th>用户名</th>
                                <th>状态</th>
                                <th>操作</th>
                                <th>创建时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="templates" id="vo"}
                            <tr>
                                <td><a href="{:url('admin/Template/detail',['id'=>$vo.tid])}">{$vo.tname}</a> </td>
                                <td>{$vo.tuser}</td>
                                <td>
                                    {if $vo.status==1}
                                    <a href="#" class="tempalte-status btn btn-success btn-xs"
                                        status="{$vo.status}">任务进行中</a> {else /}
                                    <a href="#" class="tempalte-status btn btn-danger btn-xs" 
                                        status="{$vo.status}">任务已暂停</a> {/if}
                                </td>
                                <td>{if $vo.status==1}
                                    <a href="#" class="tempalte-status btn btn-darkorange btn-xs stop-tempalte" dataid="{$vo.id}"
                                        status="{$vo.status}">暂停</a> {else /}
                                    <a href="#" class="tempalte-status btn btn-success btn-xs start-tempalte" dataid="{$vo.id}"
                                        status="{$vo.status}">开始</a> {/if}</td>
                                <td>{$vo.create_time|date='Y年m月d日 H:i'}</td>
                                    <td><a href="#" class="tempalte-status btn btn-darkorange btn-xs del-tempalte" dataid="{$vo.id}"
                                        status="{$vo.status}">删除</a> </td>
                            </tr>
                            {/volist}

                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>
{/block}

{block name="page-js"}
<script>
    
        $(".del-tempalte").click(function() {
            var id = $(this).attr('dataid');
            layer.confirm('确定删除吗？', {
                title: '删除文章',
                icon: 3
            }, function (index) {
                layer.close(index);
                $.ajax({
                    url: "{:url('admin/Templates/del')}",
                    type: 'post',
                    data: {
                        id: id
                    },
                    dataType: 'json',
                    success: function (data) {
                        if (data.code == 1) {
                            layer.msg(data.msg, {
                                icon: 6,
                                time: 2000
                            }, function () {
                                $("#table").bootstrapTable('refresh');
                            });
                        } else {
                            layer.open({
                                title: '删除文章失败！',
                                content: data.msg,
                                icon: 5,
                                anim: 5
                            });
                        }
                    }
                });
            });
        })


</script>

{/block}