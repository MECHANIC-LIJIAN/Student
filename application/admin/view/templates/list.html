{extend name="public/admin_base"}
{block name="title"}表单列表{/block}
{block name="page-breadcrumb"}
<li class="active">表单列表</li>
{/block}
{block name="page-main"}
<div class="row">
    <div class="col-xs-12">
        <div class="widget">
            <div class="widget-header bg-themeprimary">
                <i class="fa fa-arrow-left widget-icon" onClick="window.location.href='{:url(\'admin/Home/index\')}';"/></i>
                <span class="widget-caption">表单列表</span>
            </div>
            <div class="widget-body">
                <div class="table-responsive">
                    <table class="table table-hover table-bordered text-nowrap" style="padding: 2px;font-size: 10px;">
                        <thead>
                            <tr>
                                <th>表单名</th>
                                {if session('admin.is_super')==1} <th>用户名</th>{/if}
                                <th>记录数</th>
                                <th>状态</th>
                                <th colspan="3">操作</th>
                                <th>创建时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="templates" id="vo"}
                            <tr>
                                <td><a href="{:url('admin/Template/index',['id'=>$vo.tid])}" style="font-size:14px">{$vo.tname}</a> </td>
                                {if session('admin.is_super')==1}<td>{$vo.tuser}</td>{/if}
                                <td>{$vo.count}</td>
                                {if $vo.status==1}
                                <td>
                                    <span class="tempalte-status badge badge-pill badge-success"status="{$vo.status}">进行中</span>
                                </td>
                                <td>
                                    <a href="#" class="tempalte-status btn btn-warning btn-xs control-tempalte"
                                        dataid="{$vo.id}" status="{$vo.status}">暂停</a>
                                    <a href="#" class="tempalte-status btn btn-darkorange btn-xs del-tempalte disabled"
                                        dataid="{$vo.id}" status="{$vo.status}">删除</a> </td>

                                {else /}
                                <td>
                                    <span href="#" class="tempalte-status badge badge-pill badge-warning"
                                        status="{$vo.status}">已暂停</span>
                                </td>
                                <td>
                                    <a href="#" class="tempalte-status btn btn-success btn-xs control-tempalte"
                                        dataid="{$vo.id}" status="{$vo.status}">开始</a>
                                    <a href="#" class="tempalte-status btn btn-darkorange btn-xs del-tempalte"
                                        dataid="{$vo.id}" status="{$vo.status}">删除</a> </td>
                                {/if}
                                <td>
                                    <a href="{:url('admin/Template/index',['id'=>$vo.tid])}"
                                        class="btn btn-xs btn-success"><span
                                            class="fa fa-table"></span>数据</a>
                                </td>
                                <td>
                                    <a class="copy btn btn-xs btn-info" dataid="{$vo.shareUrl}"><span class="fa fa-share"></span>分享</a>
                                    <a href="{$vo.shareUrl}" target="_blank" class="btn btn-xs btn-default"><span
                                            class="fa fa-eye"></span>查看表单</a>
                                </td>
                                <td>{$vo.create_time|date='Y年m月d日 H:i'}</td>
                            </tr>
                            {/volist}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="page-js"}
<script>

    $(".del-tempalte").click(function () {
        var id = $(this).attr('dataid');
        confirm('确定删除吗？','删除表单',"{:url('admin/Templates/del')}",{id: id})
    })

    $(".control-tempalte").click(function () {
        var id = $(this).attr('dataid');
        var status = $(this).attr('status');
        if (status === "1") {
            msg = "确定暂停吗？"
            opt = "stop"
        } else {
            msg = "确定开始吗？"
            opt = "start"
        }
        confirm(msg,'表单管理确认',"{:url('admin/Templates/control')}",{id: id,opt:opt})
    })

    $(".copy").click(function () {
        var data = $(this).attr('dataid')
        copyToClip(data)
    })
</script>

{/block}